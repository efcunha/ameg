<!DOCTYPE html>
<html>
<head>
    <title>AMEG - Novo Cadastro</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/css/mobile.css">
    <style>
        body { font-family: Arial; margin: 0; background: #f4f4f4; }
        .header { background: #2c3e50; color: white; padding: 20px; }
        .nav { background: #34495e; padding: 15px; }
        .nav a { color: white; text-decoration: none; padding: 10px 20px; margin-right: 10px; background: #3498db; border-radius: 5px; }
        .container { padding: 20px; max-width: 800px; margin: 0 auto; }
        .form-card { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .form-row { display: flex; gap: 20px; margin-bottom: 15px; }
        .form-group { flex: 1; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        .btn { background: #27ae60; color: white; padding: 12px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .btn:hover { background: #229954; }
        .logout { float: right; color: white; text-decoration: none; }
    </style>
</head>
<body>
    <div class="header">
        <h1>AMEG - Novo Cadastro</h1>
        <a href="/logout" class="logout">Sair</a>
    </div>
    
    <div class="nav">
        <a href="/dashboard">Dashboard</a>
        <a href="/cadastrar">Novo Cadastro</a>
        <a href="/relatorios">Relat√≥rios</a>
        <a href="/exportar">Exportar CSV</a>
    </div>
    
    <div class="container">
        <div class="form-card">
            <h2>Cadastro Familiar</h2>
            
            <form method="POST" enctype="multipart/form-data">
                <h3>1. DADOS DO TITULAR</h3>
                
                <div class="form-group">
                    <label>Nome Completo *</label>
                    <input type="text" name="nome_completo" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Endere√ßo *</label>
                        <input type="text" name="endereco" required>
                    </div>
                    <div class="form-group">
                        <label>N√∫mero *</label>
                        <input type="text" name="numero" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Bairro *</label>
                        <input type="text" name="bairro" required>
                    </div>
                    <div class="form-group">
                        <label>CEP * <small>(preenche endere√ßo automaticamente)</small></label>
                        <input type="text" name="cep" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Telefone Celular *</label>
                        <input type="text" name="telefone" required>
                    </div>
                    <div class="form-group">
                        <label>Ponto de Refer√™ncia</label>
                        <input type="text" name="ponto_referencia">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>G√™nero *</label>
                        <select name="genero" required>
                            <option value="">Selecione</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Feminino">Feminino</option>
                            <option value="Cisg√™nero">Cisg√™nero</option>
                            <option value="Homem cis">Homem cis</option>
                            <option value="Mulher cis">Mulher cis</option>
                            <option value="Transg√™nero">Transg√™nero</option>
                            <option value="Homem trans">Homem trans</option>
                            <option value="Mulher trans">Mulher trans</option>
                            <option value="Travesti">Travesti</option>
                            <option value="N√£o-bin√°rio">N√£o-bin√°rio</option>
                            <option value="G√™nero fluido">G√™nero fluido</option>
                            <option value="Ag√™nero">Ag√™nero</option>
                            <option value="Big√™nero">Big√™nero</option>
                            <option value="Polig√™nero">Polig√™nero</option>
                            <option value="Pang√™nero">Pang√™nero</option>
                            <option value="Demig√™nero">Demig√™nero</option>
                            <option value="Demi-boy">Demi-boy</option>
                            <option value="Demi-girl">Demi-girl</option>
                            <option value="Andr√≥gino">Andr√≥gino</option>
                            <option value="Interg√™nero">Interg√™nero</option>
                            <option value="Neutrois">Neutrois</option>
                            <option value="Two-Spirit">Two-Spirit</option>
                            <option value="Queer">Queer</option>
                            <option value="G√™nero n√£o-conforme">G√™nero n√£o-conforme</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Idade *</label>
                        <input type="number" name="idade" required>
                    </div>
                    <div class="form-group">
                        <label>Data Nascimento *</label>
                        <input type="date" name="data_nascimento" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>N¬∫ T√≠tulo de Eleitor</label>
                        <input type="text" name="titulo_eleitor">
                    </div>
                    <div class="form-group">
                        <label>Cidade Emiss√£o T√≠tulo</label>
                        <input type="text" name="cidade_titulo">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>CPF *</label>
                        <input type="text" name="cpf" required>
                    </div>
                    <div class="form-group">
                        <label>RG *</label>
                        <input type="text" name="rg" required>
                    </div>
                    <div class="form-group">
                        <label>NIS</label>
                        <input type="text" name="nis">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Estado Civil *</label>
                        <select name="estado_civil" required>
                            <option value="">Selecione</option>
                            <option value="Solteiro">Solteiro(a)</option>
                            <option value="Casado">Casado(a)</option>
                            <option value="Divorciado">Divorciado(a)</option>
                            <option value="Vi√∫vo">Vi√∫vo(a)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Escolaridade *</label>
                        <select name="escolaridade" required>
                            <option value="">Selecione...</option>
                            <option value="Analfabeto">Analfabeto</option>
                            <option value="Educa√ß√£o Infantil">Educa√ß√£o Infantil</option>
                            <option value="Ensino Fundamental">Ensino Fundamental</option>
                            <option value="Ensino M√©dio">Ensino M√©dio</option>
                            <option value="Gradua√ß√£o Bacharelado">Gradua√ß√£o Bacharelado</option>
                            <option value="Gradua√ß√£o Licenciatura">Gradua√ß√£o Licenciatura</option>
                            <option value="Gradua√ß√£o Tecnol√≥gico">Gradua√ß√£o Tecnol√≥gico</option>
                            <option value="P√≥s-gradua√ß√£o Lato sensu">P√≥s-gradua√ß√£o Lato sensu</option>
                            <option value="P√≥s-gradua√ß√£o Stricto sensu">P√≥s-gradua√ß√£o Stricto sensu</option>
                            <option value="Educa√ß√£o de Jovens e Adultos (EJA)">Educa√ß√£o de Jovens e Adultos (EJA)</option>
                            <option value="Educa√ß√£o Profissional e Tecnol√≥gica (EPT)">Educa√ß√£o Profissional e Tecnol√≥gica (EPT)</option>
                            <option value="Educa√ß√£o Especial">Educa√ß√£o Especial</option>
                            <option value="Educa√ß√£o Ind√≠gena">Educa√ß√£o Ind√≠gena</option>
                            <option value="Educa√ß√£o do Campo">Educa√ß√£o do Campo</option>
                            <option value="Educa√ß√£o Quilombola">Educa√ß√£o Quilombola</option>
                            <option value="Educa√ß√£o a Dist√¢ncia (EaD)">Educa√ß√£o a Dist√¢ncia (EaD)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Profiss√£o *</label>
                        <input type="text" name="profissao" required>
                    </div>
                </div>
                
                <h3>DADOS DO COMPANHEIRO</h3>
                
                <div class="form-group">
                    <label>Nome Companheiro</label>
                    <input type="text" name="nome_companheiro">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>CPF Companheiro</label>
                        <input type="text" name="cpf_companheiro">
                    </div>
                    <div class="form-group">
                        <label>RG Companheiro</label>
                        <input type="text" name="rg_companheiro">
                    </div>
                    <div class="form-group">
                        <label>Idade Companheiro</label>
                        <input type="number" name="idade_companheiro">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>T√≠tulo Eleitor Companheiro</label>
                        <input type="text" name="titulo_companheiro">
                    </div>
                    <div class="form-group">
                        <label>Cidade T√≠tulo Companheiro</label>
                        <input type="text" name="cidade_titulo_companheiro">
                    </div>
                    <div class="form-group">
                        <label>NIS Companheiro</label>
                        <input type="text" name="nis_companheiro">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Escolaridade Companheiro</label>
                        <select name="escolaridade_companheiro">
                            <option value="">Selecione...</option>
                            <option value="Analfabeto">Analfabeto</option>
                            <option value="Educa√ß√£o Infantil">Educa√ß√£o Infantil</option>
                            <option value="Ensino Fundamental">Ensino Fundamental</option>
                            <option value="Ensino M√©dio">Ensino M√©dio</option>
                            <option value="Gradua√ß√£o Bacharelado">Gradua√ß√£o Bacharelado</option>
                            <option value="Gradua√ß√£o Licenciatura">Gradua√ß√£o Licenciatura</option>
                            <option value="Gradua√ß√£o Tecnol√≥gico">Gradua√ß√£o Tecnol√≥gico</option>
                            <option value="P√≥s-gradua√ß√£o Lato sensu">P√≥s-gradua√ß√£o Lato sensu</option>
                            <option value="P√≥s-gradua√ß√£o Stricto sensu">P√≥s-gradua√ß√£o Stricto sensu</option>
                            <option value="Educa√ß√£o de Jovens e Adultos (EJA)">Educa√ß√£o de Jovens e Adultos (EJA)</option>
                            <option value="Educa√ß√£o Profissional e Tecnol√≥gica (EPT)">Educa√ß√£o Profissional e Tecnol√≥gica (EPT)</option>
                            <option value="Educa√ß√£o Especial">Educa√ß√£o Especial</option>
                            <option value="Educa√ß√£o Ind√≠gena">Educa√ß√£o Ind√≠gena</option>
                            <option value="Educa√ß√£o do Campo">Educa√ß√£o do Campo</option>
                            <option value="Educa√ß√£o Quilombola">Educa√ß√£o Quilombola</option>
                            <option value="Educa√ß√£o a Dist√¢ncia (EaD)">Educa√ß√£o a Dist√¢ncia (EaD)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Profiss√£o Companheiro</label>
                        <input type="text" name="profissao_companheiro">
                    </div>
                    <div class="form-group">
                        <label>Data Nascimento Companheiro</label>
                        <input type="date" name="data_nascimento_companheiro">
                    </div>
                </div>
                
                <h3>2. DADOS DE RENDA FAMILIAR</h3>
                
                <div class="form-group">
                    <label>Tipo de Trabalho</label>
                    <select name="tipo_trabalho">
                        <option value="">Selecione</option>
                        <option value="Assalariado com carteira">Assalariado com carteira</option>
                        <option value="Assalariado sem carteira">Assalariado sem carteira</option>
                        <option value="Trabalhador Aut√¥nomo">Trabalhador Aut√¥nomo</option>
                        <option value="Aposentado">Aposentado</option>
                        <option value="Pensionista">Pensionista</option>
                        <option value="BPC">BPC</option>
                        <option value="Funcion√°rio P√∫blico">Funcion√°rio P√∫blico</option>
                        <option value="Desempregado">Desempregado</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Quantas pessoas trabalham?</label>
                        <input type="number" name="pessoas_trabalham" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Quantos Aposentados/Pensionistas?</label>
                        <input type="number" name="aposentados_pensionistas" required min="0">
                    </div>
                </div>
                
                <h3>3. DETALHAMENTO FAMILIAR</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>N¬∫ Pessoas na Fam√≠lia</label>
                        <input type="number" name="num_pessoas_familia" required min="1">
                    </div>
                    <div class="form-group">
                        <label>N¬∫ de Fam√≠lias</label>
                        <select name="num_familias">
                            <option value="">Selecione</option>
                            <option value="1">1 Fam√≠lia</option>
                            <option value="2">2 Fam√≠lias</option>
                            <option value="3">Mais de 2 fam√≠lias</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Adultos</label>
                        <input type="number" name="adultos" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Crian√ßas</label>
                        <input type="number" name="criancas" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Adolescentes</label>
                        <input type="number" name="adolescentes" required min="0">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Idosos</label>
                        <input type="number" name="idosos" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Gestantes</label>
                        <input type="number" name="gestantes" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Nutrizes</label>
                        <input type="number" name="nutrizes" required min="0">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Renda Familiar Bruta (R$)</label>
                        <input type="number" step="0.01" name="renda_familiar" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Renda Per Capita (R$)</label>
                        <input type="number" step="0.01" name="renda_per_capita" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Bolsa Fam√≠lia (R$)</label>
                        <input type="number" step="0.01" name="bolsa_familia" required min="0">
                    </div>
                </div>
                
                <h3>DADOS DA MORADIA</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Casa</label>
                        <select name="casa_tipo">
                            <option value="">Selecione</option>
                            <option value="pr√≥pria">Pr√≥pria</option>
                            <option value="alugada">Alugada</option>
                            <option value="cedida">Cedida</option>
                            <option value="invadida">Invadida</option>
                            <option value="compartilhada">Compartilhada</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tipo Material</label>
                        <select name="casa_material">
                            <option value="">Selecione</option>
                            <option value="alvenaria">Alvenaria</option>
                            <option value="mista">Mista</option>
                            <option value="taipa">Taipa</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Energia</label>
                        <select name="energia">
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Lixo</label>
                        <select name="lixo">
                            <option value="">Selecione</option>
                            <option value="coletado">Coletado</option>
                            <option value="queimado">Queimado</option>
                            <option value="enterrado">Enterrado</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>√Ågua</label>
                        <select name="agua">
                            <option value="">Selecione</option>
                            <option value="encanada">Encanada</option>
                            <option value="po√ßo">Po√ßo</option>
                            <option value="cisterna">Cisterna</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Esgoto</label>
                        <select name="esgoto">
                            <option value="">Selecione</option>
                            <option value="saneado">Saneado</option>
                            <option value="fossa">Fossa</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Observa√ß√µes</label>
                    <textarea name="observacoes" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                </div>
                
                <h3>DADOS DA SA√öDE DA FAM√çLIA</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Tem doen√ßa cr√¥nica?</label>
                        <select name="tem_doenca_cronica" onchange="toggleField(this, 'doencas_cronicas')">
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Quais doen√ßas cr√¥nicas?</label>
                        <input type="text" name="doencas_cronicas" id="doencas_cronicas" disabled placeholder="Ex: Diabetes, Hipertens√£o">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Usa medicamento cont√≠nuo?</label>
                        <select name="usa_medicamento_continuo" onchange="toggleField(this, 'medicamentos_continuos')">
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Quais medicamentos?</label>
                        <input type="text" name="medicamentos_continuos" id="medicamentos_continuos" disabled placeholder="Ex: Insulina, Captopril">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Tem doen√ßa mental?</label>
                        <select name="tem_doenca_mental" onchange="toggleField(this, 'doencas_mentais')">
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Quais doen√ßas mentais?</label>
                        <input type="text" name="doencas_mentais" id="doencas_mentais" disabled placeholder="Ex: Depress√£o, Ansiedade">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Tem defici√™ncia?</label>
                        <select name="tem_deficiencia" onchange="toggleField(this, 'tipo_deficiencia')">
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tipo de defici√™ncia?</label>
                        <input type="text" name="tipo_deficiencia" id="tipo_deficiencia" disabled placeholder="Ex: Visual, Auditiva, F√≠sica">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Precisa de cuidados especiais?</label>
                        <select name="precisa_cuidados_especiais" onchange="toggleField(this, 'cuidados_especiais')">
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="N√£o">N√£o</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Quais cuidados?</label>
                        <input type="text" name="cuidados_especiais" id="cuidados_especiais" disabled placeholder="Ex: Fisioterapia, Acompanhamento m√©dico">
                    </div>
                </div>
                
                <h3>ANEXOS DE SA√öDE</h3>
                <p style="color: #666; font-size: 14px;">Anexe laudos m√©dicos, receitas ou imagens relacionadas √† sa√∫de (PDF, PNG, JPG, DOC - m√°x. 16MB cada)</p>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>üìã Laudo M√©dico</label>
                        <input type="file" name="laudo" accept=".pdf,.png,.jpg,.jpeg,.doc,.docx">
                        <input type="text" name="descricao_laudo" placeholder="Descri√ß√£o do laudo (opcional)" style="margin-top: 5px;">
                    </div>
                    <div class="form-group">
                        <label>üíä Receita M√©dica</label>
                        <input type="file" name="receita" accept=".pdf,.png,.jpg,.jpeg,.doc,.docx">
                        <input type="text" name="descricao_receita" placeholder="Descri√ß√£o da receita (opcional)" style="margin-top: 5px;">
                    </div>
                    <div class="form-group">
                        <label>üì∑ Imagem/Exame</label>
                        <input type="file" name="imagem" accept=".pdf,.png,.jpg,.jpeg,.doc,.docx">
                        <input type="text" name="descricao_imagem" placeholder="Descri√ß√£o da imagem (opcional)" style="margin-top: 5px;">
                    </div>
                </div>
                
                <script>
                function toggleField(select, targetId) {
                    const target = document.getElementById(targetId);
                    if (select.value === 'Sim') {
                        target.disabled = false;
                        target.style.backgroundColor = '#fff';
                    } else {
                        target.disabled = true;
                        target.value = '';
                        target.style.backgroundColor = '#f5f5f5';
                    }
                }
                </script>
                
                <script>
                // Formata√ß√£o e valida√ß√£o de CPF
                function formatCPF(input) {
                    let value = input.value.replace(/\D/g, '');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                    input.value = value;
                }
                
                function validarCPF(cpf) {
                    cpf = cpf.replace(/[^\d]+/g, '');
                    if (cpf.length !== 11 || /^(\d)\1{10}$/.test(cpf)) return false;
                    
                    let soma = 0;
                    for (let i = 0; i < 9; i++) soma += parseInt(cpf.charAt(i)) * (10 - i);
                    let resto = (soma * 10) % 11;
                    if (resto === 10 || resto === 11) resto = 0;
                    if (resto !== parseInt(cpf.charAt(9))) return false;
                    
                    soma = 0;
                    for (let i = 0; i < 10; i++) soma += parseInt(cpf.charAt(i)) * (11 - i);
                    resto = (soma * 10) % 11;
                    if (resto === 10 || resto === 11) resto = 0;
                    return resto === parseInt(cpf.charAt(10));
                }
                
                function validarCPFInput(input) {
                    const cpf = input.value.replace(/[^\d]+/g, '');
                    if (cpf.length === 11 && !validarCPF(cpf)) {
                        input.setCustomValidity('CPF inv√°lido');
                        input.style.borderColor = '#e74c3c';
                    } else {
                        input.setCustomValidity('');
                        input.style.borderColor = '#ddd';
                    }
                }
                
                // Formata√ß√£o de telefone
                function formatTelefone(input) {
                    let value = input.value.replace(/\D/g, '');
                    if (value.length <= 11) {
                        value = value.replace(/(\d{2})(\d)/, '($1) $2');
                        value = value.replace(/(\d{4})(\d)/, '$1-$2');
                    }
                    input.value = value;
                }
                
                // Formata√ß√£o de CEP
                function formatCEP(input) {
                    let value = input.value.replace(/\D/g, '');
                    value = value.replace(/(\d{2})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                    input.value = value;
                }
                
                // Buscar endere√ßo pelo CEP
                function buscarCEP(cep) {
                    const cepLimpo = cep.replace(/\D/g, '');
                    if (cepLimpo.length === 8) {
                        fetch(`https://viacep.com.br/ws/${cepLimpo}/json/`)
                            .then(response => response.json())
                            .then(data => {
                                if (!data.erro) {
                                    document.querySelector('input[name="endereco"]').value = data.logradouro || '';
                                    document.querySelector('input[name="bairro"]').value = data.bairro || '';
                                    // Foca no campo n√∫mero ap√≥s preencher
                                    document.querySelector('input[name="numero"]').focus();
                                } else {
                                    alert('CEP n√£o encontrado!');
                                }
                            })
                            .catch(error => {
                                console.error('Erro ao buscar CEP:', error);
                            });
                    }
                }
                
                // Aplicar formata√ß√£o aos campos CPF
                document.addEventListener('DOMContentLoaded', function() {
                    const cpfInputs = document.querySelectorAll('input[name="cpf"], input[name="cpf_companheiro"]');
                    cpfInputs.forEach(input => {
                        input.addEventListener('input', function() {
                            formatCPF(this);
                            validarCPFInput(this);
                        });
                        input.maxLength = 14;
                        input.pattern = '\\d{3}\\.\\d{3}\\.\\d{3}-\\d{2}';
                    });
                    
                    // Aplicar formata√ß√£o ao campo telefone
                    const telefoneInput = document.querySelector('input[name="telefone"]');
                    if (telefoneInput) {
                        telefoneInput.addEventListener('input', function() {
                            formatTelefone(this);
                        });
                        telefoneInput.maxLength = 15;
                        telefoneInput.placeholder = '(XX) XXXX-XXXX';
                    }
                    
                    // Aplicar formata√ß√£o ao campo CEP
                    const cepInput = document.querySelector('input[name="cep"]');
                    if (cepInput) {
                        cepInput.addEventListener('input', function() {
                            formatCEP(this);
                        });
                        cepInput.addEventListener('blur', function() {
                            buscarCEP(this.value);
                        });
                        cepInput.maxLength = 10;
                        cepInput.placeholder = 'XX.XXX-XX';
                    }
                });

                // Controlar campos do companheiro baseado no estado civil
                const estadoCivil = document.querySelector('select[name="estado_civil"]');
                const camposCompanheiro = ['idade_companheiro', 'data_nascimento_companheiro'];
                
                function toggleCamposCompanheiro() {
                    const isSolteiro = estadoCivil.value === 'Solteiro';
                    camposCompanheiro.forEach(campo => {
                        const input = document.querySelector(`input[name="${campo}"]`);
                        if (input) {
                            if (isSolteiro) {
                                input.removeAttribute('required');
                                input.value = '';
                            } else {
                                input.setAttribute('required', 'required');
                            }
                        }
                    });
                }
                
                estadoCivil.addEventListener('change', toggleCamposCompanheiro);
                toggleCamposCompanheiro(); // Executar na carga da p√°gina
                </script>
                
                <button type="submit" class="btn">Salvar Cadastro</button>
            </form>
        </div>
    </div>
</body>
</html>
